<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Solutions: Putting it all together &#8212; The Text Processing Cookbook 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Visualization" href="visualization.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  
    <link rel="canonical" href="https://thejud.github.io/text-processing-cookbook/solutions.html" />
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="visualization.html" title="Previous document">Visualization</a>
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="solutions-putting-it-all-together">
<h1>Solutions: Putting it all together<a class="headerlink" href="#solutions-putting-it-all-together" title="Link to this heading">¶</a></h1>
<p>The following examples combine multiple recipes and techniques to solve real-world problems
I have encountered.</p>
<p>Note that, as always, there are <strong>many</strong> approaches to each of these, and
I often try to work through each one quickly and iteratively with
small, simple transformations.</p>
<section id="find-available-data-by-user-event-class-and-date">
<h2>Find available data by user, event class and date<a class="headerlink" href="#find-available-data-by-user-event-class-and-date" title="Link to this heading">¶</a></h2>
<p>This is a more detailed exploration of the example I showed in the <a class="reference internal" href="introduction.html"><span class="std std-doc">Introduction</span></a>.</p>
<p>Recently, I got a question about what data was available for a machine learning
project. The data was in S3, and organized by event code, user and date for a
period of several weeks. However, data ingestion had begun at different times
for different groups, and so my coworker wanted to know the available date
ranges for various event codes.</p>
<p>I was able to quickly list the files using an <code class="docutils literal notranslate"><span class="pre">s3</span> <span class="pre">ls</span> <span class="pre">--recursive</span></code> command
and store that in a local file for quick summarization.</p>
<p>Each line had a file creation date, a size, and then the file path that encodes:</p>
<ul class="simple">
<li><p>an event class</p></li>
<li><p>a user id</p></li>
<li><p>a date</p></li>
<li><p>the actual filename for a data segment</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">22</span> <span class="mi">139769207</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00005</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">8235665</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00009</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>     <span class="mi">26936</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00008</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>  <span class="mi">92385199</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1010</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00003</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">51873127</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>     <span class="mi">52364</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3001</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00003</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">11</span>  <span class="mi">53877463</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">36197597</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00005</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">14</span>     <span class="mi">54249</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00000</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">03</span> <span class="mi">146174053</span> <span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
</pre></div>
</div>
<p>I wanted to see the first and last dates available for each event code and
user, and have a rough idea if there were any big gaps by counting the number
of dates between the first and last.</p>
<p>Here’s the first few rows of  output, with the user, event class, first and
last date, and count of files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">05</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">31</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3001</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">42</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3002</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">42</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">30</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">6</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3001</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">25</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span>  <span class="mi">11</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3002</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">25</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>  <span class="mi">10</span>
</pre></div>
</div>
<p>and here is the transformation I used to summarize the data:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>/tmp/files<span class="w"> </span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $NF}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nv">user</span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>perl<span class="w"> </span>-pe<span class="s1">&#39;s/part-.*//&#39;</span><span class="w">  </span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>perl<span class="w"> </span>-pe<span class="s1">&#39;s/.*data\///&#39;</span><span class="w"> </span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>/<span class="w"> </span><span class="s1">&#39;\t&#39;</span><span class="w">  </span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>--uniq
<span class="w">    </span><span class="p">|</span><span class="w"> </span>datamash<span class="w"> </span>--group<span class="w"> </span><span class="m">2</span>,1<span class="w"> </span>first<span class="w"> </span><span class="m">3</span><span class="w"> </span>last<span class="w"> </span><span class="m">3</span><span class="w"> </span>count<span class="w"> </span><span class="m">3</span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>column<span class="w"> </span>-t
<span class="w">    </span><span class="p">|</span><span class="w"> </span>sort
</pre></div>
</div>
<p>I’ll work through the small (10 line) file list from above for conciseness and
reproducibility. As a result, the final counts will not match the output shown
above that used the entire dataset.</p>
<p>So, step by step, the process is as follows:</p>
<ol class="arabic simple">
<li><p>Take the filenemame (the last field) from each line</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $NF}&#39;</span> 
</pre></div>
</div>
<p>produces</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00009</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00005</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1010</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00003</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00000</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00008</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3001</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00003</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00005</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="extraction.html#printing-the-last-column-awk-and-perl"><span class="std std-ref">Printing the last column, awk and perl</span></a></p>
<ol class="arabic simple" start="2">
<li><p>Next, I filter for lines that contain only the string ‘user=’. It turned out
that there were other files, metadata files etc… that were also present in
the s3 output, but they were not specific to a user and so I wanted to
filter those out. Looking for the <code class="docutils literal notranslate"><span class="pre">user=</span></code> string eliminated them. This is an
example of “selecting in”.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">grep</span> <span class="n">user</span><span class="o">=</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="filter-and-select.html"><span class="std std-doc">Filter and Select</span></a></p>
<ol class="arabic simple" start="3">
<li><p>remove the trailing filename</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">perl</span> <span class="o">-</span><span class="n">pe</span><span class="s1">&#39;s/part-.*//&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">1010</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3001</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span>
<span class="n">data</span><span class="o">/</span><span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span><span class="o">/</span>
</pre></div>
</div>
<p>Each date may have multiple files, but I don’t care about individual files . So I’ll
trim it. In reality, I have a small script I’ve written called <code class="docutils literal notranslate"><span class="pre">dirnames</span></code> that
simple strips off the final path portion of each line, from the last <code class="docutils literal notranslate"><span class="pre">/</span></code>, but I
wanted to rely on standard tools for this example, so I remove everything after ‘part-’</p>
<p>See <a class="reference internal" href="transformation.html"><span class="std std-doc">Transformations</span></a></p>
<ol class="arabic simple" start="4">
<li><p>Remove the <code class="docutils literal notranslate"><span class="pre">data/</span></code> prefix</p></li>
</ol>
<p>Remove everything upto and including <code class="docutils literal notranslate"><span class="pre">data/</span></code>. This is a relatively geneneral transformation, and I used the
regular expression because in the actual data I had a few more path components to remove.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">perl</span> <span class="o">-</span><span class="n">pe</span><span class="s1">&#39;s/.*data\///&#39;</span> 
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">1010</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">bbb</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">3001</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span><span class="o">/</span>
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span><span class="o">/</span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span><span class="o">/</span><span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span><span class="o">/</span>
</pre></div>
</div>
<p>This is an example of “selecting out”. See <a class="reference internal" href="transformation.html"><span class="std std-doc">Transformations</span></a></p>
<ol class="arabic simple" start="5">
<li><p>split up the directory components by tabs</p></li>
</ol>
<p>I want to have the user, class and date as separate “words” so I can do additional processing. Converting the directory
separator <code class="docutils literal notranslate"><span class="pre">/</span></code> into a tab allows for tools (like datamash) that separate fields by whitespace or tabs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">tr</span> <span class="o">/</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>  
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1010</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3001</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span>	
</pre></div>
</div>
<p>Naturally, I could have also used perl for this, but <code class="docutils literal notranslate"><span class="pre">tr</span></code> is shorter to type and automatically converts all matches!</p>
<p>Also note that steps 3, 4 and 5 could have all been done by a single, more complicated match and replacement, but I was
working quickly and wanted simple steps I could easily iterate through.</p>
<p>See <a class="reference internal" href="transformation.html#create-several-simple-filters-rather-than-one-complicated-one"><span class="std std-ref">Create several simple filters rather than one complicated one</span></a></p>
<ol class="arabic simple" start="6">
<li><p>Sort, and keep only one line per day</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">sort</span> <span class="o">-</span><span class="n">u</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">1010</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3001</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span>	
<span class="n">class</span><span class="o">=</span><span class="mi">3002</span>	<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span>	
</pre></div>
</div>
<p>Because, in step 3 above, I removed the filename, I now had multiple directory lines per day. So, clean that up and
sort the data for the next step.</p>
<ol class="arabic simple" start="7">
<li><p>Group by user, and event class, then show the days and counts</p></li>
</ol>
<p><a class="reference external" href="https://www.gnu.org/software/datamash/">Gnu Datamash</a> makes it easy to do some quick grouping and aggregations on delimited data, and provides a few useful
text transformations like count, first, last and collapse.</p>
<p>So, because I actually am interested in which users have what data is available, I’m going to change the grouping order. I’ll group by the first two columns, and then
do some “aggregation” operations on the third: first, last, and count all work on the grouped elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">datamash</span> <span class="o">--</span><span class="n">group</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span> <span class="n">first</span> <span class="mi">3</span> <span class="n">last</span> <span class="mi">3</span> <span class="n">count</span> <span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	<span class="mi">3</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">class</span><span class="o">=</span><span class="mi">1007</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>	<span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">class</span><span class="o">=</span><span class="mi">1010</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>	<span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>	<span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>	<span class="n">class</span><span class="o">=</span><span class="mi">103006</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>	<span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">class</span><span class="o">=</span><span class="mi">3001</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>	<span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>	<span class="n">class</span><span class="o">=</span><span class="mi">3002</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span>	<span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span>	<span class="mi">2</span>
</pre></div>
</div>
<p>Note that datamash prints out items separated by tabs, so the output doesn’t line up with my default tab settings.</p>
<p>See <a class="reference internal" href="specialized-data-tools.html#datamash"><span class="std std-ref">datamash</span></a></p>
<ol class="arabic simple" start="8">
<li><p>Pretty print the data into nicer columns for easy viewing/copypaste</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">column</span> <span class="o">-</span><span class="n">t</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">3</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1010</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">103006</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">103006</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3001</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3002</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span>  <span class="mi">2</span>
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Finally, sort the data correctly so it shows up as desired.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">sort</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">3</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1010</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">103006</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">13</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3001</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">09</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">aaa</span>  <span class="n">class</span><span class="o">=</span><span class="mi">3002</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">02</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">21</span>  <span class="mi">2</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">1007</span>    <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span>  <span class="mi">1</span>
<span class="n">user</span><span class="o">=</span><span class="n">bbb</span>  <span class="n">class</span><span class="o">=</span><span class="mi">103006</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="n">date</span><span class="o">=</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">1</span>
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>Final steps</p></li>
</ol>
<p>After summarizing the data, I determines that the data began arriving on
different days for not only different users, but even within different event
classes for the same user.</p>
<p>I did a bit more cleanup (removed the <code class="docutils literal notranslate"><span class="pre">&lt;field&gt;=</span></code>), get a list of all days for each line using the datamash <code class="docutils literal notranslate"><span class="pre">collapse</span></code> aggregator, etc…</p>
<p>Then I was ready to not only answer my coworker’s question, but also send a
message to the data ingestion team about the missing days.</p>
<p>At each step in the process, I would typically pipe the output to <code class="docutils literal notranslate"><span class="pre">head</span></code> so I was only getting the top 10 results. That
was enough for me to check each step before processing onto the next, and allowed me to rapidly iterate through the examples.</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="visualization.html" title="Previous document">Visualization</a>
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/80s_keycaps.png" alt="Logo of The Text Processing Cookbook"/>
            </a></p>
<h1 class="logo"><a href="index.html">The Text Processing Cookbook</a></h1>



<p class="blurb">Tools and techniques for processing text and data on the command line by Jud Dagnall</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=thejud&repo=text-processing-cookbook&type=star&count=True&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">An Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter-and-select.html">Filter and Select</a></li>
<li class="toctree-l1"><a class="reference internal" href="extraction.html">Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation.html">Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="grouping-data.html">Grouping Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="frequency-counts-and-distributions.html">Frequency Counts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="specialized-data-tools.html">Specialized Tools for Aggregation, Summary, Analysis and Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="csv-tsv-json.html">CSV and TSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="csv-tsv-json.html#json">json</a></li>
<li class="toctree-l1"><a class="reference internal" href="sorting.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="generating-data.html">Generating Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch-and-parallel-execution.html">Batch and parallel execution with xargs and parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#misc">Misc</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Solutions: Putting it all together</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#find-available-data-by-user-event-class-and-date">Find available data by user, event class and date</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="visualization.html" title="previous chapter">Visualization</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Jud Dagnall.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/solutions.md.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/thejud/text-processing-cookbook" class="github">
        <img src="_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>